(this.webpackJsonpAvisRestaurant=this.webpackJsonpAvisRestaurant||[]).push([[0],{142:function(e,t,a){e.exports=a(350)},147:function(e,t,a){},148:function(e,t,a){},346:function(e,t,a){},347:function(e,t,a){},348:function(e,t,a){},349:function(e,t,a){},350:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(56),s=a.n(l),o=a(23),i=a(1),c=(a(84),a(147),a(148),a(19)),u=[{featureType:"all",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#838383"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#c4c4c4"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#aaaaaa"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21},{visibility:"on"}]},{featureType:"poi.business",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#6e6e6e"},{lightness:"0"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#575757"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{color:"#2c2c2c"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#999999"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]}],m=r.a.createContext({restaurants:[],updateRestaurants:function(e){}}),p=Object(c.withScriptjs)(Object(c.withGoogleMap)((function(e){var t=Object(n.useContext)(m),a=t.restaurants,l=t.updateRestaurants,s=t.handleMarkerClick,p=Object(n.useContext)(m),g=p.tmpRestaurants,f=p.setUpdateTmpRestaurants,d=Object(n.useState)(null),v=Object(i.a)(d,2),y=v[0],h=v[1],E=Object(n.useState)(null),b=Object(i.a)(E,2),j=b[0],T=b[1],O=Object(n.useState)({lat:null,lng:null}),N=Object(i.a)(O,2),w=N[0],x=N[1],C=Object(n.useState)(!1),I=Object(i.a)(C,2),D=I[0],R=I[1];Object(n.useEffect)((function(){x(e.location)}),[e.location]);var S=Object(n.useState)({lat:null,lng:null}),A=Object(i.a)(S,2),k=A[0],z=A[1],M=function(){e.fetchRestaurants(F.getCenter().lat(),F.getCenter().lng())},_=Object(n.useState)(),L=Object(i.a)(_,2),F=L[0],G=L[1],B=function(e){G(e)},P=function(e,t){s(e.restaurantID,t),h(!0===t?e:null),T(null)},V=Object(n.useState)(""),W=Object(i.a)(V,2),q=W[0],H=W[1],U=Object(n.useState)(1),K=Object(i.a)(U,2),J=K[0],X=K[1],Z=Object(n.useState)(""),Y=Object(i.a)(Z,2),Q=Y[0],$=Y[1],ee=Object(n.useState)(""),te=Object(i.a)(ee,2),ae=te[0],ne=te[1];return r.a.createElement("div",null,r.a.createElement(c.GoogleMap,{ref:B,onDragEnd:M,onClick:function(e){return function(e){R(!0),z({lat:e.latLng.lat(),lng:e.latLng.lng()})}(e)},defaultZoom:15,defaultCenter:{lat:45.764042,lng:4.835659},center:w,defaultOptions:{styles:u,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:window.google.maps.ZoomControlStyle.SMALL},mapTypeControl:!0,mapTypeControlOptions:{style:window.google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:window.google.maps.ControlPosition.TOP_RIGHT}}},r.a.createElement(c.Marker,{position:w,animation:window.google.maps.Animation.DROP,onClick:function(){T(w),h(null)},icon:{url:"/here.png",scaledSize:new window.google.maps.Size(20,20)}}),j&&r.a.createElement(c.InfoWindow,{position:w,options:{pixelOffset:new window.google.maps.Size(0,-20)},onCloseClick:function(){T(null)}},r.a.createElement("div",null,r.a.createElement("h2",{style:{fontSize:"14px"}},"Vous \xeates ici"))),a.map((function(e){return r.a.createElement(c.Marker,{onClick:function(){return P(e,!0)},animation:window.google.maps.Animation.DROP,key:e.restaurantID,position:{lat:e.lat,lng:e.lng},icon:{url:"/logo_resto.png",scaledSize:new window.google.maps.Size(30,30)}})})),y&&r.a.createElement(c.InfoWindow,{position:{lat:y.lat,lng:y.lng},onCloseClick:function(){return P(y,!1)},options:{pixelOffset:new window.google.maps.Size(0,-30)}},r.a.createElement("div",null,r.a.createElement("h2",{style:{fontSize:14}},y.restaurantName)))),D?r.a.createElement("div",{className:"addResto"},r.a.createElement("h3",null,"Ajouter un restaurant"),r.a.createElement("div",{className:"inputNom"},r.a.createElement("div",{style:{width:"221px",marginRight:"10px",marginTop:"16px",color:"white"}},"Nom du restaurant"),r.a.createElement("input",{type:"text",className:"textNomRestaurant",name:"Nom du restaurant",placeholder:"Le Fourvi\xe8re",value:Q,onChange:function(e){$(e.target.value),e.target.style.color="white"}})),r.a.createElement("div",{className:"inputAdresse"},r.a.createElement("div",{style:{marginRight:"10px",marginTop:"16px",color:"white"}},"Adresse"),r.a.createElement("input",{type:"text",className:"textAdresse",name:"Adresse",placeholder:"8 place de Fourvi\xe8re, Lyon",value:ae,onChange:function(e){ne(e.target.value),e.target.style.color="white"}})),r.a.createElement("div",{className:"newComment"},r.a.createElement("select",{className:"selectNote",id:"note",value:J,onChange:function(e){return X(parseInt(e.target.value))}},r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5")),r.a.createElement("input",{type:"text",className:"textCommentaire",name:"Commentaire",placeholder:"Ins\xe9rer un nouveau commentaire",value:q,onChange:function(e){H(e.target.value),e.target.style.color="white"}})),r.a.createElement("input",{type:"submit",className:"btnAjoutRestaurant",value:"Ajouter",onClick:function(){return function(e,t,n,r){var s={};s.restaurantID=e+"-ID",s.restaurantName=e,s.address=t,s.lat=k.lat,s.lng=k.lng,s.ratings=[{comment:r,stars:n}],s.average=n,s.ratingsTotal=1,s.img="/logo_resto.png",l([].concat(Object(o.a)(a),[s])),f([].concat(Object(o.a)(g),[s])),R(!1),$(""),ne(""),X(1),H("")}(Q,ae,J,q)}})):null)}))),g=(a(346),a(57)),f=(a(347),a(348),function(e){var t=Object(n.useContext)(m),a=t.tmpRestaurants,l=t.updateTmpRestaurants,s=Object(n.useState)(a.filter((function(t){return t.restaurantID===e.restaurant.restaurantID}))[0]),o=Object(i.a)(s,2),c=o[0],u=o[1],p=Object(n.useState)(c.average),f=Object(i.a)(p,2),d=f[0],v=f[1],y=Object(n.useState)(""),h=Object(i.a)(y,2),E=h[0],b=h[1],j=Object(n.useState)(1),T=Object(i.a)(j,2),O=T[0],N=T[1],w="https://maps.googleapis.com/maps/api/streetview?size=312x240&location="+c.lat+","+c.lng+"&heading=151.78&pitch=-0.76&key=AIzaSyDhYcj8hX50sSL6zzWj_G68tIep3P5MWog";Object(n.useEffect)((function(){N(O)}),[O]);var x=function(e){var t=e.ratings.length,n=e.average;e.ratings.map((function(t){return e.average+=t.stars}));var r=(n*(e.ratingsTotal-1)+e.ratings[t-1].stars)/e.ratingsTotal;e.average=parseFloat(r.toFixed(2)),v(e.average);var s=a;s.map((function(t){return t.restaurantID===e.restaurantID?t=e:null})),l(s)};return r.a.createElement("div",{className:"details"},r.a.createElement("div",{className:"detailsRestaurant"},r.a.createElement("img",{className:"imgRestaurantDetails",src:w,alt:""}),r.a.createElement("div",{className:"infoRestaurantDetails"},r.a.createElement("h2",null,c.restaurantName),r.a.createElement("div",{className:"moyenneAvis"},r.a.createElement("span",{className:"moyenneAvisText"},d),r.a.createElement("img",{className:"etoileAvis",src:"etoile.png",alt:"Etoile des avis"}),r.a.createElement("span",{className:"nbRatings"},c.ratingsTotal," avis")),r.a.createElement("div",{className:"adresse"},c.address))),c.ratings.map((function(e){return r.a.createElement("div",{className:"note"},r.a.createElement("span",null,e.stars),r.a.createElement("img",{src:"etoile.png",className:"imgAvisDetails",alt:"Etoile des avis"}),r.a.createElement("div",{className:"avis"},e.comment))})),r.a.createElement("div",{className:"newComment"},r.a.createElement("select",{className:"selectNote",id:"selectNote",value:O,onChange:function(e){return function(e){N(parseInt(e.target.value))}(e)}},r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5")),r.a.createElement("input",{type:"text",className:"textCommentaire",name:"Commentaire",placeholder:"Ins\xe9rer un nouveau commentaire",value:E,onChange:function(e){b(e.target.value),e.target.style.color="white"}}),r.a.createElement("input",{type:"submit",className:"btnAjoutCommentaire",value:"\u2192",onClick:function(){return function(e,t){var n=a.filter((function(e){return e.restaurantID===t.restaurantID})),r={};r.stars=O,r.comment=e,n[0].ratings.push(r),n[0].ratingsTotal=n[0].ratingsTotal+1,u(Object(g.a)({},t,{restaurant:n[0]})),b(""),document.getElementsByClassName("textCommentaire")[0].style.color="grey",x(t)}(E,c)}})))}),d=function(e){var t=Object(n.useContext)(m),a=t.tmpRestaurants,l=t.updateTmpRestaurants,s=Object(n.useState)(a.filter((function(t){return t.restaurantID===e.restaurantID}))[0]),c=Object(i.a)(s,2),u=c[0],p=c[1],d=Object(n.useState)(!1),v=Object(i.a)(d,2),y=v[0],h=v[1],E=function(e){fetch("https://maps.googleapis.com/maps/api/place/details/json?place_id=".concat(e.restaurantID,"&fields=name,rating,reviews,geometry,formatted_address,photos,place_id&key=AIzaSyA1j6BRMbbmh3M1qFh9jGzbFAa5NxGVbHI")).then((function(e){return e.json()})).then((function(e){return b(e)})).then((function(e){l(Object(o.a)(a))})).catch((function(e){return console.log(e)}))},b=function(e){if(e.result.reviews){var t=e.result.reviews,a=u;return t.map((function(e){var t={};t.stars=e.rating,t.comment=e.text,a.ratings.push(t)})),[].push(a),a}return null};return r.a.createElement("div",{className:"card"},r.a.createElement("li",{key:u.restaurantID,className:"itemList",id:"restaurant-"+u.restaurantID,onClick:function(e){if("selectNote"!==e.target.className&&"textCommentaire"!==e.target.className&&"btnAjoutCommentaire"!==e.target.className){p(Object(g.a)({},u,{displayDetails:!u.displayDetails}));var t=a;t.map((function(e){return e.restaurantID===u.restaurantID&&(e.displayDetails=!u.displayDetails)})),y||(E(u),h(!0)),l(t)}}},a.filter((function(t){return t.restaurantID===e.restaurantID}))[0].displayDetails?r.a.createElement(f,{restaurant:u}):r.a.createElement("div",{className:"cardRestaurant"},r.a.createElement("img",{className:"imgRestaurant",src:u.img,alt:"Le restaurant"}),r.a.createElement("div",{style:{marginTop:"auto",marginBottom:"auto"}},r.a.createElement("h2",null,u.restaurantName),r.a.createElement("div",{className:"moyenneAvis"},r.a.createElement("span",{className:"moyenneAvisText"},a.filter((function(t){return t.restaurantID===e.restaurantID}))[0].average),r.a.createElement("img",{src:"etoile.png",className:"etoileAvis",alt:"Etoile des avis"}),r.a.createElement("span",{className:"nbRatings"},a.filter((function(t){return t.restaurantID===e.restaurantID}))[0].ratingsTotal," avis")),r.a.createElement("div",{className:"adresse"},u.address)))))},v=function(e){var t=Object(n.useContext)(m),a=t.tmpRestaurants;t.updateTmpRestaurants;return a?r.a.createElement("ul",{className:"list"},a.map((function(e){return r.a.createElement(d,{key:e.restaurantID,restaurantID:e.restaurantID})}))):r.a.createElement("div",null,"Chargement des restaurants...")},y=function(e){var t=Object(n.useContext)(m),a=t.restaurants,l=(t.updateRestaurants,Object(n.useContext)(m)),s=(l.tmpRestaurants,l.updateTmpRestaurants),o=Object(n.useState)(1),c=Object(i.a)(o,2),u=c[0],p=c[1],g=Object(n.useState)(5),f=Object(i.a)(g,2),d=f[0],y=f[1];Object(n.useEffect)((function(){p(u),y(d),h()}),[u,d]);var h=function(){a&&s(a.filter((function(e){return null===e.average&&1===u&&5===d?e:e.average>=u&&e.average<=d?e:void 0})))};return r.a.createElement("div",null,r.a.createElement("div",{className:"sectionTitre"},r.a.createElement("div",{className:"titreSite"},r.a.createElement("a",{href:"",className:"titre"},"Restaurants")),r.a.createElement("div",{className:"filtreAvis"},r.a.createElement("select",{id:"select-min",value:u,onChange:function(e){return function(e){p(parseInt(e.target.value))}(e)}},r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5")),r.a.createElement("span",null,"\xe0"),r.a.createElement("select",{id:"select-max",value:d,onChange:function(e){return function(e){y(parseInt(e.target.value))}(e)}},r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5")),r.a.createElement("span",null,"\xe9toiles"))),r.a.createElement(v,{valueMin:u,valueMax:d}))},h=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],l=t[1],s=Object(n.useState)([]),c=Object(i.a)(s,2),u=c[0],g=c[1],f=Object(n.useState)({lat:null,lng:null}),d=Object(i.a)(f,2),v=d[0],h=d[1],E=Object(n.useState)(!1),b=Object(i.a)(E,2),j=b[0],T=b[1],O=function(e,t){var n,r=a.map((function(a){return a.restaurantID===e?(n=a,a.displayDetails=!!t,a):(a.displayDetails=!1,a)}));l(r),g(r),fetch("https://maps.googleapis.com/maps/api/place/details/json?place_id=".concat(e,"&fields=name,rating,reviews,geometry,formatted_address,photos,place_id&key=AIzaSyA1j6BRMbbmh3M1qFh9jGzbFAa5NxGVbHI")).then((function(e){return e.json()})).then((function(e){return N(e,n)})).then((function(e){g(Object(o.a)(r))})).catch((function(e){return console.log(e)}))},N=function(e,t){if(e.result.reviews){var a=e.result.reviews,n=t;return a.map((function(e){var t={};t.stars=e.rating,t.comment=e.text,n.ratings.push(t)})),[].push(n),n}return null},w={restaurants:a,updateRestaurants:l,handleMarkerClick:O,tmpRestaurants:u,updateTmpRestaurants:function(e){g(e);var t=a;console.log(e);for(var n=0;n<a.length;n++)for(var r=0;r<u.length;r++){var s=u[r],o=a[n];s.restaurantID===o.restaurantID&&(t[n]=s)}console.log(t),l(t)},setUpdateTmpRestaurants:g};Object(n.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){var t={};t.lat=e.coords.latitude,t.lng=e.coords.longitude,h(t),x(e.coords.latitude,e.coords.longitude)}),C)}),[]);var x=function(e,t){fetch("https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=".concat(e,",").concat(t,"&radius=1000&type=restaurant&key=AIzaSyA1j6BRMbbmh3M1qFh9jGzbFAa5NxGVbHI")).then((function(e){return e.json()})).then((function(e){return I(e)})).then((function(e){l(e),g(e)})).catch((function(e){return console.log(e)}))},C=function(e){e&&T(!0)},I=function(e){var t=[];return e.results.map((function(e){var a={};a.restaurantID=e.place_id,a.restaurantName=e.name,a.address=e.vicinity,a.lat=e.geometry.location.lat,a.lng=e.geometry.location.lng,a.ratings=[],e.rating?a.average=e.rating:a.average=null,e.user_ratings_total?a.ratingsTotal=e.user_ratings_total:a.ratingsTotal=0,e.photos&&e.photos.length>0?a.img="https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=".concat(e.photos[0].photo_reference,"&key=AIzaSyA1j6BRMbbmh3M1qFh9jGzbFAa5NxGVbHI"):a.img="/logo_resto.png",t.push(a)})),t};return r.a.createElement(m.Provider,{value:w},r.a.createElement("div",{className:"appCSS"},r.a.createElement("div",{className:"map",style:{width:"65vw",height:"100vh"}},r.a.createElement(p,{googleMapURL:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=AIzaSyBbXlKpycaKnkWqib5h17gluphKw_nLENs",loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"100%"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),handleMarkerClick:O,location:v,transformDatas:I,fetchRestaurants:x})),r.a.createElement("div",{style:{width:"35vw",height:"100vh"}},j?r.a.createElement("div",null,r.a.createElement("img",{src:"/localisation.jpg",style:{height:"200px",marginTop:"55%",marginLeft:"28%",marginRight:"20%"}}),r.a.createElement("div",{style:{color:"#f5f8b3",textAlign:"center",width:"265px",marginLeft:"25%",marginTop:"30px"}},"Veuillez activer la g\xe9olocalisation pour continuer d'utiliser l'application")):r.a.createElement("div",{className:"general"},r.a.createElement(y,{tmpRestaurants:a})))))};a(349);s.a.render(r.a.createElement(h,null),document.getElementById("root"))},84:function(e,t,a){}},[[142,1,2]]]);
//# sourceMappingURL=main.0f57ba31.chunk.js.map